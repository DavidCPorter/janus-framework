
- hosts: "{{hosts_ui}}"

  # OYSTA main vars
  vars:
    module_root: "{{JANUS_HOME}}/r_modules/{{stage}}/{{module}}"
    user_root_dir: "{{home}}"

  gather_facts: no

  tasks:

  - name: including user-defined variables for this branch
    include_vars: '{{branch_file_ui}}'
    tags:
      - always

  - name: including default variables for this play
    include_vars: '{{module_root}}/defaults/main.yml'
    tags:
      - always

  - name:
    template:
      src: '{{module_root}}/defaults/main.yml'
      dest: '{{show_vars_file}}'
    delegate_to: localhost
    tags:
      - never
      - debug

  - name: evolve to active state,   hosts_ui -> tasks_file_ui
    include_tasks: '{{module_root}}/plays/{{tasks_file_ui}}'
    tags:
      - activate
      - utils
      - never

  - name: revert to inactive state,   hosts_ui -> tasks_file_ui
    include_tasks: '{{module_root}}/plays/{{tasks_file_ui}}'
    tags:
      - deactivate
      - never


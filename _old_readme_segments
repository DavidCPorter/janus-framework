
### upgrading solr:
http://lucene.apache.org/solr/guide/8_3/solr-upgrade-notes.html#solr-upgrade-notes

**feature changes 8->8.1**
*Collections API*
- The CREATE command will now return the appropriate status code (4xx, 5xx, etc.) when the command has failed. Previously, it always returned 0, even in failure.


*Logging*
- (we turn logging off... but goood to know) The default Log4j2 logging mode has been changed from synchronous to asynchronous. This will improve logging throughput and reduce system contention at the cost of a slight chance that some logging messages may be missed in the event of abnormal Solr termination.

**feature changes 8.1->8.2**
*Zookeeper*
- ZooKeeper 3.5.5
- This ZooKeeper release includes many new security features. In order for Solr’s Admin UI to work with 3.5.5, the zoo.cfg file must allow access to ZooKeeper’s "four-letter commands". At a minimum, ruok, conf, and mntr must be enabled, but other commands can optionally be enabled if you choose. See the section Configuration for a ZooKeeper Ensemble for details.
- add this to zoo.cfg::: 4lw.commands.whitelist=mntr,conf,ruok

*Distributed Tracing Support*
- woo! This release adds support for tracing requests in Solr. Please review the section Distributed Solr Tracing for details on how to configure this feature.

*Caches*

- Solr has a new cache implementation, CaffeineCache, which is now recommended over other caches. This cache is expected to generally provide most users lower memory footprint, higher hit ratio, and better multi-threaded performance.Since caching has a direct impact on the performance of your Solr implementation, before switching to any new cache implementation in production, take care to test for your environment and traffic patterns so you fully understand the ramifications of the change.
- A new parameter, maxIdleTime, allows automatic eviction of cache items that have not been used in the defined amount of time. This allows the cache to release some memory and should aid those who want or need to fine-tune their caches.



**UPGRADING SOLR STEPS**
- run play zoo_configure.yml --tags burn_zoo
- stop solr
- change solr install dir
- change solr git branch name in inventory
- change aws bucket name to new dir for this verison
- delete solr dir and data dirs with `play solr_configure_all.yml --tags burn_solr`
- run `play solr_configure_all.yml --tags setup --extra-vars "solr_bin_exec=/users/dporte7/solr-8_3/solr/bin/solr"`
- change defaults in zoo role for new version download link
- add this to zoo.cfg: 4lw.commands.whitelist=mntr,conf,ruok
- run `play zoo_configure.yml`

i.e. these commands should work in sequence as long as the directory names are changed
```
play zoo_configure.yml --tags burn_zoo
play solr_configure_all.yml --tags burn_solr
play zoo_configure.yml
play solr_configure_all.yml --tags setup --extra-vars "solr_bin_exec=/users/dporte7/solr-8_3/solr/bin/solr"
```
